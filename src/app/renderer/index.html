<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; worker-src 'self' blob:;">
  <title>PrismGB</title>
  <style>
    /* Critical CSS - prevents flash of unstyled content */
    html { background: #0f0f1e; }
    body {
      opacity: 0;
      background: linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 50%, #16213e 100%);
    }
    body.ready { opacity: 1; transition: opacity 0.15s ease; }
    .app-logo { height: 30px; width: 120px; }
    .app-icon { width: 54px; height: 54px; }
  </style>
</head>
<body>
  <!-- Atmospheric color orbs for depth -->
  <div class="prismatic-orbs" aria-hidden="true"></div>
  <div class="app-container">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <h1>
          <img class="app-logo pixelated" src="/assets/Logo.png" width="120" height="30" alt="PrismGB">
        </h1>
        <div class="device-status" id="deviceStatus">
          <span class="status-indicator" id="statusIndicator"></span>
          <span id="statusText">Checking device...</span>
        </div>
      </div>
      <div class="header-right">
        <button class="btn btn-secondary" id="fullscreenBtn" aria-label="Toggle Fullscreen">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
          </svg>
        </button>
        <div class="settings-control">
          <button class="btn btn-primary" id="settingsBtn" aria-label="Open Settings" aria-expanded="false">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
          </button>
          <div class="settings-menu-container popup-animated" id="settingsMenuContainer">
            <div class="settings-menu" role="menu" aria-label="Settings">
              <!-- Settings Section -->
              <section class="settings-section settings-main">
                <h3 class="settings-section-title">Display</h3>
                <label class="settings-item toggle">
                  <span>Show Status Bar</span>
                  <input type="checkbox" id="settingStatusStrip">
                  <span class="toggle-slider"></span>
                </label>
              </section>

              <!-- Compact Footer -->
              <footer class="settings-footer">
                <span class="settings-version" id="appVersion">v1.0.0</span>
                <div class="settings-footer-links">
                  <a href="#" id="linkGithub" class="settings-icon-link" aria-label="GitHub" title="GitHub">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                      <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                  </a>
                  <a href="#" id="linkWebsite" class="settings-icon-link" aria-label="Website" title="Website">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                      <circle cx="12" cy="12" r="10"></circle>
                      <line x1="2" y1="12" x2="22" y2="12"></line>
                      <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                  </a>
                  <button id="disclaimerBtn" class="settings-icon-link settings-info-btn" aria-label="Disclaimer & Credits" title="Disclaimer & Credits" aria-expanded="false">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                      <circle cx="12" cy="12" r="10"></circle>
                      <line x1="12" y1="16" x2="12" y2="12"></line>
                      <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                  </button>
                </div>
              </footer>
            </div>
            <!-- Disclaimer Tooltip - positioned below menu -->
            <div class="disclaimer-tooltip popup-animated" id="disclaimerContent">
              <p><strong>This is an unofficial, community-developed application.</strong></p>
              <p>PrismGB is not affiliated with, endorsed by, or sponsored by Mod Retro. The Chromatic is a product of Mod Retro.</p>
              <p>For official Chromatic support and information, please visit <a href="#" id="linkModRetro" class="disclaimer-link">modretro.com</a>.</p>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Stream View -->
      <section class="stream-section">
        <div class="stream-container" id="streamContainer">
          <video id="streamVideo" autoplay playsinline></video>
          <canvas id="streamCanvas" class="pixelated"></canvas>
          <div class="stream-overlay" id="streamOverlay">
            <!-- Floating Particles -->
            <div class="overlay-particles" aria-hidden="true">
              <span class="particle particle-1"></span>
              <span class="particle particle-2"></span>
              <span class="particle particle-3"></span>
              <span class="particle particle-4"></span>
              <span class="particle particle-5"></span>
              <span class="particle particle-6"></span>
            </div>

            <!-- Scanline shimmer effect (full viewport) -->
            <div class="scanlines" aria-hidden="true"></div>

            <!-- Main Content -->
            <div class="overlay-content">
              <div class="icon-wrapper">
                <!-- Pulsing rings for ready state -->
                <div class="ready-ring ready-ring-inner" aria-hidden="true"></div>
                <div class="ready-ring ready-ring-outer" aria-hidden="true"></div>
                <div class="ready-ring ready-ring-ripple" aria-hidden="true"></div>
                <!-- Radial glow behind gem -->
                <div class="gem-glow" aria-hidden="true"></div>
                <!-- Flash overlay for transition -->
                <div class="ready-flash" aria-hidden="true"></div>
                <img class="overlay-icon pixelated" src="/assets/overlay-icons/default.svg" width="150" height="150" alt="">
              </div>
              <!-- Hidden but kept for JS state management -->
              <p id="overlayMessage" class="sr-only waiting">Click to start</p>
            </div>
          </div>

          <!-- Stream Toolbar -->
          <div class="stream-toolbar" id="streamToolbar">
          <!-- Shader Button + Panel -->
          <div class="toolbar-item toolbar-capture" id="shaderControls">
            <button class="toolbar-btn" id="shaderBtn" aria-label="Shader Selection" aria-expanded="false">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <line x1="4" y1="21" x2="4" y2="14"></line>
                <line x1="4" y1="10" x2="4" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12" y2="3"></line>
                <line x1="20" y1="21" x2="20" y2="16"></line>
                <line x1="20" y1="12" x2="20" y2="3"></line>
                <line x1="1" y1="14" x2="7" y2="14"></line>
                <line x1="9" y1="8" x2="15" y2="8"></line>
                <line x1="17" y1="16" x2="23" y2="16"></line>
              </svg>
            </button>
            <div class="shader-panel" id="shaderDropdown">
              <div class="panel-content">
                <div class="shader-controls-container">
                  <div class="shader-options"></div>
                  <div class="brightness-control">
                    <div class="brightness-icon">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                      </svg>
                    </div>
                    <input type="range" min="0" max="100" value="50" class="brightness-slider" id="brightnessSlider" aria-label="Brightness level">
                    <span class="brightness-percentage" id="brightnessPercentage">50%</span>
                  </div>
                  <div class="volume-control-vertical">
                    <div class="volume-icon">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                        <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                        <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
                      </svg>
                    </div>
                    <input type="range" min="0" max="100" value="70" class="volume-slider-vertical" id="volumeSliderVertical" aria-label="Volume level">
                    <span class="volume-percentage-vertical" id="volumePercentageVertical">70%</span>
                  </div>
                </div>
                <div class="panel-divider"></div>
                <button type="button" class="cinematic-pill" id="cinematicToggle" aria-pressed="false">
                  <span class="cinematic-pill-text">Cinematic Off</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Screenshot Button -->
          <button class="toolbar-btn toolbar-capture toolbar-screenshot" id="screenshotBtn" aria-label="Take Screenshot" disabled>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
              <circle cx="12" cy="13" r="4"></circle>
            </svg>
          </button>

          <!-- Record Button -->
          <button class="toolbar-btn toolbar-capture toolbar-record" id="recordBtn" aria-label="Start Recording" aria-pressed="false" disabled>
            <!-- Normal record dot icon -->
            <svg class="record-dot" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none" aria-hidden="true">
              <circle cx="12" cy="12" r="6"></circle>
              <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"></circle>
            </svg>
            <!-- Recording state: static dot + spinning outer ring -->
            <svg class="record-spinner" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true">
              <circle cx="12" cy="12" r="6" fill="currentColor"></circle>
              <circle class="spinner-ring" cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2" stroke-dasharray="28 28" stroke-linecap="round"></circle>
            </svg>
          </button>
          </div>

          <!-- Floating Fullscreen Controls (visible only in fullscreen mode) -->
          <div class="fullscreen-controls" id="fullscreenControls">
            <!-- Exit Fullscreen Button -->
            <button class="fs-control-btn" id="fsExitBtn" aria-label="Exit fullscreen">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"></path>
              </svg>
            </button>
          </div>
        </div>
      </section>

    </main>

    <!-- Footer -->
    <footer class="footer status-hidden">
      <div class="footer-right">
        <div class="status-strip" aria-live="polite">
          <div class="status-message sr-only" id="statusMessage" role="status">Checking device...</div>
          <div class="status-metrics" aria-label="Stream details">
            <div class="metric-chip" id="deviceStatusText">Disconnected</div>
            <div class="metric-chip">
              <span class="metric-label">Device</span>
              <span class="metric-value" id="deviceName">—</span>
            </div>
            <div class="metric-chip">
              <span class="metric-label">Resolution</span>
              <span class="metric-value" id="currentResolution">—</span>
            </div>
            <div class="metric-chip">
              <span class="metric-label">FPS</span>
              <span class="metric-value" id="currentFPS">—</span>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <script type="module" src="/src/app/renderer/index.js"></script>
</body>
</html>
